import"./style.css";import*as THREE from"three";import{GLTFLoader}from"three/examples/jsm/loaders/GLTFLoader";import{EffectComposer}from"three/examples/jsm/postprocessing/EffectComposer";import{RenderPass}from"three/examples/jsm/postprocessing/RenderPass";import{ShaderPass}from"three/examples/jsm/postprocessing/ShaderPass";import{ColorCorrectionShader}from"three/examples/jsm/shaders/ColorCorrectionShader";import{DRACOLoader}from"three/examples/jsm/loaders/DRACOLoader";import{fireflies,createFirefly}from"./fireflies.js";import{DarkenShader}from"./shaders";const scene=new THREE.Scene,camera=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,.1,1e3);camera.rotation.x=Math.PI;const renderer=new THREE.WebGLRenderer({canvas:document.querySelector("#bg")}),composer=new EffectComposer(renderer),renderPass=new RenderPass(scene,camera);composer.addPass(renderPass);const darkenPass=new ShaderPass(DarkenShader);darkenPass.uniforms.amount.value=.6,composer.addPass(darkenPass);const colorCorrectionPass=new ShaderPass(ColorCorrectionShader);colorCorrectionPass.uniforms.powRGB.value=new THREE.Vector3(.8,.8,.8),colorCorrectionPass.uniforms.mulRGB.value=new THREE.Vector3(1.3,1.3,1.3),composer.addPass(colorCorrectionPass),composer.setSize(renderer.getSize(new THREE.Vector2).width,renderer.getSize(new THREE.Vector2).height);const width=window.innerWidth,height=window.innerHeight;camera.aspect=width/height,camera.updateProjectionMatrix(),renderer.setSize(width,height),window.addEventListener("resize",(function(){const e=window.innerWidth,t=window.innerHeight;camera.aspect=e/t,camera.updateProjectionMatrix(),renderer.setSize(e,t)}),!1),camera.position.setZ(10),camera.position.setX(-10),scene.fog=new THREE.Fog(4536286,.5,80);const lightDistance=10,warmColors=[16754688,16729344,16776960,16737095,16744272],lightLocations=[[-17,0,23],[-19,0,33],[2,0,60],[-4,0,69],[-10,0,83],[-15,0,83]],navTargets={About:10.22,"Game-Engine":21.74,Projects:26.45,Accomplishments:50.21,Work:57.86,Skills:64.34,Contact:69.22};function getRandomWarmColor(){const e=Math.floor(Math.random()*warmColors.length);return warmColors[e]}function createPointLight(e,t,o,n,r=10){const i=new THREE.PointLight(e,t,o);return i.position.set(...n),i.intensity=r,i.distance=10,scene.add(i),i}const pointLight=new THREE.PointLight(getRandomWarmColor(),.2,100);pointLight.position.set(10,10,10),pointLight.intensity=2,scene.add(pointLight);const lights={house1:createPointLight(getRandomWarmColor(),.2,100,lightLocations[0]),house2:createPointLight(getRandomWarmColor(),.2,100,lightLocations[1]),house3:createPointLight(getRandomWarmColor(),.2,100,lightLocations[2]),house4:createPointLight(getRandomWarmColor(),.2,100,lightLocations[3],5),house5:createPointLight(getRandomWarmColor(),.2,100,lightLocations[4],2),house6:createPointLight(getRandomWarmColor(),.2,100,lightLocations[5],2)},ambientLight=new THREE.AmbientLight(2105376,.3);scene.add(pointLight,ambientLight);const directionalLight=new THREE.DirectionalLight(16777215,.3);directionalLight.position.set(5,5,5),scene.add(directionalLight);const spotLight=new THREE.SpotLight(16711680,.5);spotLight.position.set(10,10,10),scene.add(spotLight);const hemisphereLight=new THREE.HemisphereLight(16777147,526368,.1);scene.add(hemisphereLight),ambientLight.color.set(4210752),ambientLight.intensity=.5;const spaceTexture=(new THREE.TextureLoader).load("nightsky.png");scene.background=spaceTexture;const loader=new GLTFLoader,dLoader=new DRACOLoader;dLoader.setDecoderPath("https://www.gstatic.com/draco/versioned/decoders/1.5.6/"),dLoader.setDecoderConfig({type:"js"}),loader.setDRACOLoader(dLoader);let degrees=20;loader.load("ForestPathPortfolioCompressed.glb",(function(e){e.scene.position.set(14,0,0),e.scene.rotation.x=Math.PI,scene.add(e.scene)}),void 0,(function(e){console.error(e)}));const maxScrollableHeight=200*Math.abs(navTargets.contact-navTargets.home);document.body.style.height=`${maxScrollableHeight}px`,document.onreadystatechange=function(){if("interactive"==document.readyState||"complete"==document.readyState){var e,t=document.getElementsByClassName("accordion");for(e=0;e<t.length;e++)t[e].addEventListener("click",(function(){this.classList.toggle("active");var e=this.nextElementSibling;e.style.maxHeight?e.style.maxHeight=null:e.style.maxHeight=e.scrollHeight+"px"}));!function e(){!function(){for(var e=0;e<t.length;e++)t[e].style.animation=""}();var o=Array.from(t).filter((e=>!e.classList.contains("active")));o.length&&(o[Math.floor(Math.random()*o.length)].style.animation="hintToPress 2s",setTimeout((()=>{e()}),2e3))}()}},document.querySelectorAll(".card").forEach((e=>{e.addEventListener("mousemove",(t=>{let o=e.getBoundingClientRect(),n=t.clientX-o.left,r=10*-((t.clientY-o.top)/o.height-.5),i=10*(n/o.width-.5);e.style.transform=`rotateX(${r}deg) rotateY(${i}deg)`})),e.addEventListener("mouseleave",(()=>{e.style.transform="rotateX(0) rotateY(0)"}))})),$(window).on("load",(function(){window.addEventListener("wheel",(function(){$("html, body").stop(),cameraTargetZ=void 0})),$("#navbar a").on("click",(function(e){if(""!==this.hash){e.preventDefault();var t=this.hash,o=$(window).scrollTop(),n=$(t).offset().top-.1*$(window).height();if(Math.abs(o-n)<2)return;window.location.hash!==t&&$("html, body").stop();var r=$(t).data("cameraZ");cameraTargetZ=r,$("html, body").animate({scrollTop:n},800,(function(){void 0!==cameraTargetZ&&history.pushState(null,null,t)}))}})),$(document).on("scroll",(function(){var e=$(document).scrollTop()+.3*$(window).height();$("section").each((function(){var t=$(this);if(t.position().top<=e&&t.position().top+t.height()>e){var o=t.attr("id");$("#navbar a").removeClass("active"),$("#navbar a[href='#"+o+"']").addClass("active")}}))}))})),document.querySelector(".nav-toggle").addEventListener("click",(function(){this.classList.toggle("active")}));for(let e=0;e<50;e++){const e=createFirefly(scene);fireflies.push(e)}function moveCameraOnScroll(){let e=10-.005*document.body.getBoundingClientRect().top;e<minScrollZ&&(e=minScrollZ),e>maxScrollZ&&(e=maxScrollZ),void 0===cameraTargetZ&&Math.abs(camera.position.z-e)>.01&&(camera.position.z+=.05*(e-camera.position.z))}let cameraTargetZ,minScrollZ=0,maxScrollZ=75;const navbar=document.getElementById("navbar"),navToggle=document.getElementById("navToggle"),leafBg=document.getElementById("leafBg");function moveCameraToTarget(){void 0!==cameraTargetZ&&Math.abs(camera.position.z-cameraTargetZ)>.001?camera.position.z+=.05*(cameraTargetZ-camera.position.z):void 0!==cameraTargetZ&&Math.abs(camera.position.z-cameraTargetZ)<=.001&&(cameraTargetZ=void 0)}function updateFireflies(){fireflies.forEach((({firefly:e,fireflyLight:t,velocity:o})=>{e.position.add(o),t.position.copy(e.position),(e.position.x<-10||e.position.x>10)&&(o.x=-o.x),(e.position.y<-10||e.position.y>10)&&(o.y=-o.y),(e.position.z<-10||e.position.z>10)&&(o.z=-o.z),t.intensity=.8+.2*Math.sin(.005*Date.now())}))}function animate(){requestAnimationFrame(animate),updateFireflies(),console.log("Number of draw calls:",renderer.info.render.calls),renderer.render(scene,camera)}navToggle.addEventListener("click",(()=>{navbar.classList.toggle("active")})),document.body.onscroll=moveCameraOnScroll,animate();const fieldsOfInterest=["Game Developer","Game Engine Programmer","Web Developer"];let index=0,charIndex=0,isDeleting=!1;const typingEffectElement=document.getElementById("typing-effect");let currentField=fieldsOfInterest[index];function type(){!isDeleting&&charIndex<=currentField.length?(typingEffectElement.textContent+=currentField[charIndex]||"",charIndex++,setTimeout(type,100)):isDeleting&&charIndex>0?(typingEffectElement.textContent=typingEffectElement.textContent.slice(0,-1),charIndex--,setTimeout(type,50)):0===charIndex&&isDeleting?(isDeleting=!1,index=(index+1)%fieldsOfInterest.length,currentField=fieldsOfInterest[index],setTimeout(type,500)):(isDeleting=!0,setTimeout(type,1e3))}type();